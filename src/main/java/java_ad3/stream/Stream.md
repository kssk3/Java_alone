# Stream

## Stream API 란?
**정의**  
- **스트림(Stream)** 은 자바 8부터 추가된 기능으로, **데이터의 흐름을 추상화**해서 다루는 도구이다.  
- **컬렉션(Collection) 또는 배열 등**의 요소들은 **연산 파이프라인**을 통해 **연속적인 형태**로 처리할 수 있게 해준다.  
  - 연산 파이프라인: 여러 연산(중간 연산, 최종 연산)을 **체이닝**해서 데이터를 변환, 필터링, 계산하는 구조  
  
> **용어 : 파이프라인**  
> 스트림이 여러 단계를 거쳐 변환되고 처리되는 모습이 **마치 물이 여러 파이프(관)를 타고 이동하면서 정수 시설이나 필터를 거치는 과정**  
> 과 유사하다. 각 파이프 구간마다 (중간 연산) 데이터를 가공하고, 마지막 종착지(종료 연산)까지 흐른다는 개념이 비슷하기 때문에  
> "파이프라인"이라는 용어를 사용한다.  
  
**스트림 특징**  
1. 데이터 소스를 변경하지 않음(Immutable)  
   - 스트림에서 제공하는 연산들은 원본 컬렉션 (예: `List`, `Set`)을 변경하지 않고 **결과만 새로 생성**한.
2. 일회성 (1회 소비)  
   - 한 번 사용(소비)된 스트림은 다시 사용할 수 없으며, 필요하다면 **새로 스트림을 생성**해야 한다.
3. 파이프라인(PipeLine)구성  
   - **중간 연산**(`map`, `filter` 등)들이 이어지다가, **최종 연산**(`forEach`, `collect`, `reduce`)을 만나야  
    연산이 수행되고 종료된다.  
4. 지연 연산 (Lazy Operation)
   - 중간 연산은 필요할 때까지 실제로 동작하지 않고, 최종 연산이 실행될 때 한 번에 처리된다.
5. 병렬 처리(Parallel)용이
   - 스트림으로부터 **병렬 스트림(Parallel Stream)** 을 쉽게 만들 수 있어서, 멀티코어 환경에서  
    병렬 연산을 비교적 단순한 코드로 작성할 수 있다.
  
### 지연 연산 정리
스트림 API에서 **지연 연산**(Lazy Operation, 게으른 연산)이란, `filter`, `map`같은 **중간 연산**들은 `toList`와 같은  
**최종 연산(terminal operation)** 이 호출되기 전까지 실제로 실행되지 않는다는 의미이다.  
- 즉 중간 연산들은 결과를 **바로 계산**하지 않고, "무엇을 할지"**설정**만 저장해 둔다.  
- 그리고 최종 연산(예 : `toList()`,`forEach()`, `findFirst()`등)이 실행되는 순간, **그때서야** 중간 연산이  
순차적으로 **한 번에** 수행된다.  
  
이를 통해 얻을 수 있는 장점은 다음과 같다.  
1. **불필요한 연산의 생략 (단축, Short-Circuiting)**  
   - `findFirst()`, `limit()` 같은 단축 연산을 사용하면, 결과를 찾은 시점에서 더 이상 나머지 요소들을 처리할 필요가 없다.  
   - 스트림이 실제 데이터를 처리하기 직전에, "이후 연산 중에 어차피 건너뛰어도 되는 부분"을 알아내 **불필요한 연산을 피할 수 있게** 된다.  
2. **메로리 사용 효율**  
   - 중간 연산 결과를 매 단계마다 별도의 자료구조에 저장하지 않고, 최종 연산 때까지 **필요할 때마다 가져와서 처리**한다.
3. **파이프라인 최적화**  
   - 스트림은 요소를 하나씩 꺼내면서 (순차적으로) `filter`, `map`등 연산을 **묶어서** 실행할 수 있다.  
   - 요소를 하나 꺼냈으면 -> 그 요소에 대한 `filter` -> 통과하면 `map` -> ... -> 최종 연산까지 진행하고, 다음 요소로 넘어 간다.  
   - 이렇게 하면 메모리를 절약할 수 있고, 매번 중간단계를 저장하지 않아도 되므로, 내부적으로 효율적으로 동작한다.  
  
### 기본형 특화 스트림 (IntStream, LongStream, DoubleStream)
- 박싱 / 언박싱 오버헤드를 줄이고, 합계, 평균, 최솟값, 최댓값, 범위 생성 같은 **숫자 처리에 특화된 메서드**를 제공한다.
- 일반 스트림보다 루프가 매우 큰 상황에서 성능상 이점이 있을 수 있고, `range()`, `rangeClosed()`를 통해  
반복문 없이 손쉽게 범위를 다룰 수도 있다.  
  
### Collector 와 Collectors
- `collect`최종 연산을 통해 스트림 결과를 **리스트나 맵, 통계 정보** 등 원하는 형태로 모을 수 있다.  
- `Collectors`클래스는 `toList()`,`groupingBy()`,`partitioningBy`,`mapping`,`averageInt`  
같은 **다양한 수집용 메서드**를 제공한다.
- 특히 `grupingBy`나 `partitioningBy`에 **다운 스트림 컬렉터**를 지정하면, "그룹별 합계, 평균, 최대/최솟값, 여러형태로 다시 맵핑"  
등 **복합적인 요구사항**을 한 번에 처리할 수 있다.
  
이처럼 스트림은 **가독성, 선언형 코드, 지연 연산에 따른 최적화**라는 장점을 제공한다. 간단한 데이터 필터링이나 변환부터  
대규모 그룹화 / 집계 처리까지, 여러 상황에서 복잡한 반복문 없이 직관적인 코드를 작성할 수 있다.  
스트림을 이해하고 적절히 활용하면, 실무에서 매우 큰 데이터도 효율적이고 깔끔하게 처리할 수 있다.  

